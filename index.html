<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>TGRASS: temporal data processing with GRASS GIS</title>
  <meta name="description" content="Short course TGRASS: temporal data processing with GRASS GIS">
  <meta name="author" content="Veronica Andreo, Luca Delucchi, Markus Neteler">
  <link rel="shortcut icon" href="grass.png">

  <script type="text/javascript" src="lib/jquery.js"></script>
  <script type="text/javascript" src="lib/codetabs.js"></script>

<!--
<link rel="stylesheet" href="http://yandex.st/highlightjs/8.0/styles/default.min.css">
<script src="http://yandex.st/highlightjs/8.0/highlight.min.js"></script>
-->

  <script type="text/javascript" src="lib/highlights/highlight.pack.js"></script>
  <link rel="stylesheet" href="lib/highlights/styles/default.css">
  <link rel="stylesheet" href="css/grassdocs.css">
  <link rel="stylesheet" href="css/codetabs.css">

<style type="text/css">
.hljs{
    display: none;
    /*padding: 0em;*/
}
</style>

</head>

<body>

  <div id="container">
<!-- TODO fix div for logo usage and proper centering -->
    <a href="https://europe.foss4g.org/2017/" title="FOSS4G EU 2017"><img src="foss4g_eu_2017.png" width="22%" height="22%" align="left" alt="FOSS4G EU 2017 logo">
    </a><a href="https://grass.osgeo.org" title="GRASS GIS"><img src="grassgis_logo_colorlogo_text_whitebg.png" width="19%" height="19%" align="right" alt="GRASS GIS logo"></a>
    <h1 align="center">TGRASS: temporal data processing with GRASS GIS</h1>
    <h2 class="notoc" align="center">FOSS4G Europe 2017 workshop</h2>
    <p align="center">
    <a href="https://veroandreo.wordpress.com/" target="_blank">Veronica Andreo</a>, <a href="http://www.lucadelu.org" target="_blank">Luca Delucchi</a> and <a href="https://www.mundialis.de/en/neteler/" target="_blank">Markus Neteler</a>
<!--
	meter una animacion de NC
-->
    </p>
    <p style="border-top-style: solid; border-bottom-style: solid; border-width: 5px; border-color: rgb(130, 130, 130); padding-top: 5px;">

    <p>
    Course outline:
    <ul>
        <li><a href="#grassgisintro">Introduction to GRASS GIS</a></li>
        <li><a href="#temporalintro">Introduction to GRASS Temporal Framework</a></li>
    <!--
        links to "traditional" presentations for both introductions (?)
    -->
        <li><a href="#temporalhands">Hands-on to raster time series processing</a></li>
    </ul>
    </p>
    <p>
    Software requirements:
    <ul>
        <li>GRASS GIS 7.2: <a href="https://grass.osgeo.org/download/software/">download</a> | <a href="https://live.osgeo.org/">OSGeo-live</a></li>
        <li>
            GRASS GIS Add-ons: <a href="https://grass.osgeo.org/grass72/manuals/addons/r.modis.download.html">r.modis.download</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/addons/r.modis.import.html">r.modis.import</a> and
            <a href="https://grass.osgeo.org/grass72/manuals/addons/v.strds.stats.html">v.strds.stats</a>
        </li>
        <li> <a href="http://www.pymodis.org">pyModis</a> library</li>
<!--
	<li>matplotlib with pyplot
	(included in GRASS installation for MS Windows; package python-matplotlib for Ubuntu)</li>
-->
    </ul>
    </p>
    <p>
    Sample data:
    <ul>
        <li>Main dataset: <a href="https://grass.osgeo.org/sampledata/north_carolina/nc_spm_08_grass7.tar.gz">North Carolina basic location (50 MB)</a>
        <ul>
<!-- TODO add url: -->
            <li>extra "mapset" <code>modis_lst</code>: monthly land surface temperature (LST) from MODIS sensor (MOD11B3.006) for North Carolina (2015-2016)</li>
        </ul>
    </ul>
    </p>
    <p style="border-top-style: solid; border-bottom-style: solid; border-width: 5px; border-color: rgb(130, 130, 130); padding-top: 5px;">

    <p>
    <h2><a name="grassgisintro">GRASS GIS introduction</a></h2>
    <h3>GRASS DATABASE, LOCATION, MAPSET</h3>
    The <b>GRASS DATABASE</b> (also called "GISDBASE") is an existing directory the projects are organized by project areas stored in subdirectories called LOCATIONs.<br />
    A <b>LOCATION</b> is defined by its coordinate system, map projection and geographical boundaries.<br />
    In a <b>MAPSET</b> you can organize GIS maps thematically or geographically or by project or whatever.<br />
<!-- Add Vaclav image after my suggested modification -->
    <h3>Raster and vector maps</h3>
    GRASS GIS is able to read the most common GIS data format, mainly through GDAL library. GRASS GIS has it's own format to manage raster and vector data, so our data have to be imported or linked into a GRASS session. <br />
    The <b>vector format is topological one</b>, this means that adjacent geographic components in a single vector map are related. For example in a non-topological GIS if two areas shared a common border that border would be digitized two times and also stored in duplicate. In a topological GIS this border exists once and is shared between two areas. Topological representation of vector data helps to produce and maintain vector maps with clean geometry as well as enables certain analyses that can not be conducted with non-topological or spaghetti data. <br />
    <div class="imagebox">
        <img style="width: 700px;" src="figures/datatypes.png" alt="Vector data types" title="Vector data types"><br />
        All the vector data types
    </div>

    <h3>Modules</h3>
    GRASS GIS is composed by 450 and more modules to run any kind of GIS analisys. It is possible to analize raster, imagery, vector, alphanumeric attributes.<br />
    It is possible to install other modules, called Addons, from a centralized repository using the command  <a href="https://grass.osgeo.org/grass72/manuals/g.extension.html">g.extension</a>
    <div class="imagebox">
        <img style="width: 100%;" src="figures/grass_gis_command_families.png" alt="GRASS GIS command families" title="GRASS GIS command families"><br />
        GRASS GIS command families
    </div>
    <h3>Region and Mask</h3>
    The <b>computational (or current) region</b> is the <i>actual setting of the region boundaries and the actual raster resolution</i>.<br />
    The raster input maps are automatically cropped/padded and rescaled to match the current region, the output maps have their bounds and resolution equal to those of the current computational region, instead vector maps are always considered completely.
    <div class="imagebox">
        <img style="width: 600px;" src="figures/region.png" alt="Show computational region" title="Show computational region"><br/>
        The red box show the computational region
    </div>
    <em>MASK</em>: if the mask is set raster modules will operate only on data falling inside the masked area, and treat any data falling outside of the mask as if its value were NULL. To set the mask you can use <a href="https://grass.osgeo.org/grass72/manuals/r.mask.html" target="_blank">r.mask</a> or creating a raster called <code>MASK</code><br/>
    <div class="imagebox">
        <img style="width: 600px;" src="figures/mask.png" alt="Show MASK effect" title="Show MASK effect"><br />
        Setting the MASK only the data inside the masked area are used
    </div>

    <h3>Interfaces</h3>
    GRASS GIS has different interfaces for the interaction between user and software, let's see them...
    <h5>Graphical User Interface</h5>
    The GUI is the simpler way to approach GRASS GIS. The <a href="https://grass.osgeo.org/grass72/manuals/wxGUI.html" target="_blank">GRASS GIS GUI</a> is composed by two element, the <code>Layer Manager</code> where you can find all the GRASS GIS modules and you can manage your data and the <code>Map Display</code> where you can navigate, print and query your maps.
    <div class="imagebox">
        <img style="width: 98%;" src="figures/grass_gis_gui.png" alt="GRASS GIS GUI" title="GRASS GIS GUI"><br />
        GRASS GIS Graphical User Interface
    </div>
    Otherwise you can also use GRASS GIS inside QGIS using the <code>GRASS GIS plugin</code> or through <code>Processing</code>.
    <h5>Command line</h5>
    The command line is the older and, probably, the more powerful way to use GRASS GIS, most of the GRASS GIS power user use it daily.

    <h5>Python</h5>
    Python is a powerful and simple programming language, you can use it to:
    <ul>
        <li>interface with GRASS GIS</li>
        <li>create your own procedure using several GRASS GIS modules</li>
        <li>create a new addons using GRASS GIS modules or an ample number of libraries</li>
    </ul>
    <div class="imagebox">
        <img style="width: 98%;" src="figures/grass_gis_python.png" alt="GRASS GIS Python interface" title="GRASS GIS Python interface"><br />
        An example of Python code to run GRASS GIS modules
    </div>
    <h5>WPS</h5>
    It is possible to run GRASS GIS modules trought the web using the <a href="https://en.wikipedia.org/wiki/Web_Processing_Service" target="_blank">Web Processing Service</a> (WPS is an <a href="https://en.wikipedia.org/wiki/Open_Geospatial_Consortium" target="_blank">OGC</a> standard). The Free and Open Source software <a href="http://zoo-project.org/" target="_blank">ZOO-Project</a> and <a href="http://pywps.org/" target="_blank">PyWPS</a> allow the user to run GRASS GIS command in a simple way.

    <h2><a name="temporalintro">Temporal GRASS GIS introduction</a></h2>
    <p>
<!--
        First TGIS Open Source with capabilities to manage, analyze,
        process and visualize spatio-temporal data, as well as, the
        temporal relationships among time series.

        TGRASS concept is based on metadata. It uses an SQL database to
        store temporal and spatial extension of STDS, maps and maps
        metadata, as well as the topological relationships among maps
        and among STDS
-->
    <h3>Terminology overview</h3>
    <h5>Temporal database</h5>

    A mapset specific table in which all time stamped maps are registered,
    i.e.: their spatial and temporal extents, unique ID and map type metadata are stored.
    This allows complex SQL queries using the spatio-temporal extent and metadata information for map selection.

    <h5>Space-time datasets</h5>
    <ul>
        <li>Space time raster datasets (<b>STRDS</b>) collections of time stamped raster maps.</li>
        <li>Space time 3D raster datasets (<b>STR3DS</b>) collections of time stamped 3D raster maps.</li>
        <li>Space time vector datasets (<b>STVDS</b>) collections of time stamped vector maps.</li>
    </ul>
	<h5>Spatio-temporal modules</h5>
	<ul>
		<li><b>t.*</b>: General modules to handle stds of all types</li>
		<li><b>t.rast.*</b>: Modules that process strds</li>
		<li><b>t.rast3d.*</b>: Modules that process str3ds</li>
		<li><b>t.vect.*</b>: Modules that process stvds</li>
	</ul>
    <p>
    <h5>Absolute time vs relative time</h5>
    <p>
    <table style="width:70%" border="1" align="center" bgcolor="#FFFFFF">
      <tr>
        <th>Absolute</th>
        <th>Relative</th>
      </tr>
      <tr>
        <td>Gregorian calendar (ISO 8601 time format notation)</td>
        <td>An integer and a time unit (year, month, day, hour, minute, seconds)</td>
      </tr>
      <tr>
        <td>Example: 2013-10-15 13:00:00</td>
        <td>Example: 4 years, 90 days, 1 second</td>
      </tr>
    </table>
    <h5>Time intervals vs time instances</h5>
    <p>
    <table style="width:70%" border="1" align="center" bgcolor="#FFFFFF">
      <tr>
          <th>Time intervals</th>
          <th>Time instances</th>
      </tr>
      <tr>
          <td>Defined by start time and end time: [start, end)</td>
          <td>Defined by start time</td>
      </tr>
      <tr>
          <td>Support for gaps, Allows overlapping, Might contain time instances, Irregularly spaced in time</td>
          <td>Punctual event</td>
      </tr>
    </table>
    <h5>Granularity</h5>
    <p>
    The largest common divider granule of time intervals and gaps between intervals or instances from all time stamped spatial
    fields that are collected in a STDS. It is represented as a number of seconds, minutes, hours, days, weeks, months or years.
<!--
    <h5>Temporal topology</h5>
    <p>
    The temporal relations between time stamps represented by interval time or time instances. Several
	algorithms in TGRASS need to check the temporal topology of space time datasets for validity. A valid temporal topology allows only
	the following temporal relationships: follows/precedes and after/before.

	<h5>Temporal sampling</h5>
    <p>
    to identify temporally related spatial fields of two space time datasets.
-->
    <h3>Workflow overview</h3>
<!--
MAKE NICE FLOWCHART
-->
    <ol>
        <li>Set and connect the temporal database (mapset specific): <a href="https://grass.osgeo.org/grass72/manuals/t.connect.html">t.connect</a></li>
        <li>Create the STDS (raster, vector or raster 3D): <a href="https://grass.osgeo.org/grass72/manuals/t.create.html">t.create</a></li>
        <li>Assign timestamps to maps and register them in the STDS: <a href="https://grass.osgeo.org/grass72/manuals/t.register.html">t.register</a></li>
        <li>
            Check info, integrity and validity of STDS: <a href="https://grass.osgeo.org/grass72/manuals/t.list.html">t.list</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.info.html">t.info</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.topology.html">t.topology</a>
        </li>
        <li>
            Edition, updating, unregistering, removal of maps and/or STDS: <a href="https://grass.osgeo.org/grass72/manuals/t.rename.html">t.rename</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.remove.html">t.remove</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.support.html">t.support</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.unregister.html">t.unregister</a>
        </li>
        <li>
            Listing maps, selections, univariate statistics:
            <a href="https://grass.osgeo.org/grass72/manuals/t.rast.list.html">t.rast.list</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.vect.list.html">t.vect.list</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.select.html">t.select</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.rast.extract.html">t.rast.extract</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.vect.extract.html">t.vect.extract</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.rast.univar.html">t.rast.univar</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/t.vect.univar.html">t.vect.univar</a>
        </li>
        <li>Spatio-temporal processing (a bit raster biased):
            <ul>
                <li>
                    data aggregation: <a href="https://grass.osgeo.org/grass72/manuals/t.rast.series.html">t.rast.series</a>,
                    <a href="https://grass.osgeo.org/grass72/manuals/t.rast.aggregate.html">t.rast.aggregate</a>,
                    <a href="https://grass.osgeo.org/grass72/manuals/t.rast.aggregate.ds.html">t.rast.aggregate.ds</a>
                </li>
                <li>
                    data accumulation: <a href="https://grass.osgeo.org/grass72/manuals/t.rast.accumulate.html">t.rast.accumulate</a>,
                    <a href="https://grass.osgeo.org/grass72/manuals/t.rast.accumulate.html">t.rast.accumulate</a>,
                </li>
                <li>
                    gap-filling and smoothing: <a href="https://grass.osgeo.org/grass72/manuals/t.rast.gapfill.html">t.rast.gapfill</a>,
                    <a href="https://grass.osgeo.org/grass72/manuals/t.rast.neighbors.html">t.rast.neighbors</a>
                </li>
                <li>
                    spatio-temporal algebra: <a href="https://grass.osgeo.org/grass72/manuals/t.rast.mapcalc.html">t.rast.mapcalc</a>,
                    <a href="https://grass.osgeo.org/grass72/manuals/t.rast.algebra.html">t.rast.algebra</a>
                </li>
            </ul>
        </li>
        <li>
            Visualization: <a href="https://grass.osgeo.org/grass72/manuals/g.gui.timeline.html">g.gui.timeline</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/g.gui.tplot.html">g.gui.tplot</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/g.gui.animation.html">g.gui.animation</a>,
            <a href="https://grass.osgeo.org/grass72/manuals/g.gui.mapswipe.html">g.gui.mapswipe</a>
        </li>
    </ol>

    <h2><a id="temporalhands">Hands-on to raster time series processing</a></h2>
    <h3>Get MODIS data</h3>
    Create the <i>SETTING</i> file with the following content:
    <p>
    your_NASA_user
    your_NASA_password
    <pre>
        <code class="neutral">
r.modis.download -g settings=$HOME/gisdata/SETTING product=lst_terra_monthly_5600 tiles=h11v05 startday="2015-01-01" endday="2016-12-31" folder=$HOME/lst_monthly
r.modis.import -w files=$HOME/lst_monthly/listfileMOD11B3.006.txt spectral="( 1 1 0 0 1 1 )" outfile=$HOME/lst_monthly/monthly_lst_to_register.txt
g.list type=raster patern="MOD11B3*"
        </code>
        <code class="bash">
# Download data: MOD11B3 2015-2016, tile h11v05
r.modis.download -g settings=$HOME/gisdata/SETTING \
product=lst_terra_monthly_5600 \
tiles=h11v05 startday="2015-01-01" endday="2016-12-31" \
folder=$HOME/lst_monthly

# Reproject and import maps into NC Location (Day and Night)
r.modis.import -w files=$HOME/lst_monthly/listfileMOD11B3.006.txt \
spectral="( 1 1 0 0 1 1 )" \
outfile=$HOME/lst_monthly/monthly_lst_to_register.txt

# Check list of imported maps
g.list type=raster patern="MOD11B3*"
        </code>
        <code class="python">
# import the needed libraries
import grass.pygrass.modules as gmod
import os
from subprocess import PIPE
# set variables
# home
HOME=os.path.expanduser('~')
# stdout

# Download data: MOD11B3 2015-2016, tile h11v05
gmod.Module("r.modis.download", flags="g", settings=os.path.join(HOME, 'gisdata', 'SETTING'),
product="lst_terra_monthly_5600", tiles="h11v05", startday="2015-01-01",
endday="2016-12-31", folder=os.path.join(HOME, lst_monthly)

# Reproject and import maps into NC Location (Day and Night)
gmod.Module("r.modis.import", flags="w" files=os.path.join(HOME, 'lst_monthly', 'listfileMOD11B3.006.txt'),
spectral="( 1 1 0 0 1 1 )", outfile=os.path.join(HOME, 'lst_monthly', 'monthly_lst_to_register.txt'))

# Check list of imported maps
glist = gmod.Module("g.list", type="raster", patern="MOD11B3*", stdout_=PIPE, stderr_=PIPE)
print(glist.outputs["stdout"].value)
        </code>
    </pre>
    <p>We will now visualize one image and add different map decorations</p>
    <p>
    <pre>
        <code class="neutral">
# change color palette from grey to viridis
r.colors MOD11B3.A2015060.h11v05.single_LST_Day_6km color=viridis
# set region to NC (g.region -d)
g.region -p vector=nc_state
# optionally, to the full extent of one of the raster maps
g.region -p raster=MOD11B3.A2015060.h11v05.single_LST_Day_6km
        </code>
    </pre>
    <p>We can open a monitor and run the commands from the command line or do everything in the main GUI and copy the commands for future reference or replication.</p>
    <pre>
        <code class="neutral">
# open a monitor
d.mon wx0
# display raster
d.rast map=MOD11B3.A2015060.h11v05.single_LST_Day_6km
# display vector
d.vect map=nc_state type=boundary
# add raster legend
d.legend -t -s -d -b raster=MOD11B3.A2015060.h11v05.single_LST_Day_6km \
title=LST title_fontsize=20 font=sans fontsize=18
# add scale bar
d.barscale length=200 units=kilometers segment=4 fontsize=14
# add north arrow
d.northarrow style=1b text_color=black
# add text
d.text -b text="LST Day from MOD11B3.006 - North Carolina - March, 2015" \
color=black bgcolor=229:229:229 align=cc font=sans size=8
        </code>
    </pre>
    <p style="text-align:center">
    <div class="imagebox">
        <img style="width: 600px;" src="figures/mod11b3_nc.png" alt="display LST map with decorations" title="display LST map with decorations">
    </div>
    </p>
    <h3>Create temporal dataset (STRDS)</h3>
    <pre>
        <code class="neutral">
# Create the temporal db connection
t.connect -d

# Create STRDS
t.create type=strds temporaltype=absolute output=LST_Day_monthly \
 title="Monthly LST Day 5.6 km" \
 description="Monthly LST Day 5.6 km MOD11B3.006, 2015-2016"

# Check if the STRDS is created
t.list type=strds
t.info input=LST_Day_monthly
        </code>
    </pre>
    <p>Once the STRDS is created, we add the maps into it, i.e.: we <it>register</it> maps into the STRDS.</p>
    <pre>
        <code class="neutral">
# Register maps in STRDS
t.register input=LST_Day_monthly \
 file=$HOME/lst_monthly/monthly_lst_to_tregister.txt

# Check info
t.info LST_Day_monthly

# Check maps in the STRDS
t.rast.list LST_Day_monthly
        </code>
    </pre>
    <p>Let's see it graphically</p>
    <pre>
        <code class="neutral">
g.gui.timeline inputs=LST_Day_monthly
        </code>
    </pre>
    <!--
    # plot here
    -->
    <p>Alternatively, we could have registered maps as follows:</p>
    <pre>
        <code class="neutral">
t.register -i input=LST_Day_monthly \
 maps=`g.list type=raster pattern=MOD11B3*LST_Day* separator=comma` \
 start="2015-01-01" increment="1 months"
        </code>
    </pre>
    <p>For more options to register maps, you can also check the related <a href="https://grasswiki.osgeo.org/wiki/Temporal_data_processing/maps_registration" target="_blank">wiki</a> page.</p>
    <h3>Temporal data analysis</h3>
    <p>Listing maps in STRDS</p>
    <pre>
        <code class="neutral">
# maps with minimum value lower than or equal to 14000
t.rast.list input=LST_Day_monthly_celsius order=min \
columns=id,name,start_time,min where="min <= '14000'"

# maps with maximum value higher than 14000
t.rast.list input=LST_Day_monthly_celsius order=max \
columns=name,start_time,max where="max > '14000'"

# maps between two given dates
t.rast.list input=LST_Day_monthly_celsius \
where="start_time >= '2015-03' and start_time <= '2016-01'"

# maps from January
t.rast.list input=LST_Day_monthly_celsius \
where="strftime('%m', start_time)='01'"

# maps from January, 1st
t.rast.list input=LST_Day_monthly_celsius \
where="strftime('%m-%d', start_time)='01-01'"
        </code>
    </pre>
    <!--
    some example output here?
    -->
    <p>Univariate statistics for maps in the STRDS</p>
    <pre>
        <code class="neutral">
# summary stats for maps within STRDS
t.rast.univar input=cla separator=comma output=stats_cla.csv
        </code>
    </pre>
    <p>Transform data from K*0.02 to C and set a proper color palette for the STRDS</p>
    <pre>
        <code class="neutral">
t.rast.algebra basename=LST_Day_monthly_celsius \
 expression="LST_Day_monthly_celsius = (LST_Day_monthly*0.02) - 273.15"
t.rast.colors input=LST_Day_monthly_celsius color=celsius
        </code>
    </pre>
    <p>Temporal aggregations</p>
    <p>We will use t.rast.series to obtain the maximum absolute LST in the past two years and t.rast.aggregate to get 3-month and 6-months average LST</p>
    <pre>
        <code class="neutral">
# max LST
t.rast.series input=LST_Day_monthly_celsius \
output=LST_Day_max_2015_2016 \
method=maximum
        </code>
    </pre>
    <pre>
        <code class="neutral">
# 3-month mean
t.rast.aggregate input=LST_Day_monthly_celsius \
output=LST_Day_mean_3month \
basename=LST_Day_mean_3month suffix=gran \
method=average granularity="3 months"

# 6-month mean
t.rast.aggregate input=LST_Day_monthly_celsius \
output=LST_Day_mean_6month \
basename=LST_Day_mean_6month suffix=gran \
method=average granularity="6 months"
        </code>
    </pre>
    <p>Now, by means of the spatio-temporal algebra, we will get the month in which the absolute maximum LST occurred. For that, we first
    compare our LST_Day_monthly_celsius STRDS with the map of absolute maximum LST. If they coincide, we keep the month for that pixel, otherwise
    it will be NULL. Then, we aggregate the resulting STRDS month_max_lst with t.rast.series method=maximum and we get a map with the month in
    which the absolute maximum LST have occurred in the past two years. We remove the intermediate STRDS, since we are only interested in the
    aggregated map</p>
    <pre>
        <code class="neutral">
# new strds with moth of overall maximum
t.rast.mapcalc -n inputs=LST_Day_monthly_celsius output=month_max_lst \
expression="if(LST_Day_monthly_celsius == LST_Day_max_2015_2016, start_month(), null())" \
basename=month_max_lst

# map with month of overall maximum
t.rast.series input=month_max_lst method=maximum output=max_lst_date

# remove month_max_lst strds (we were only interested in the resulting aggregated map)
t.remove -rf inputs=month_max_lst
        </code>
    </pre>
    <p>Note that "-rf" forces removal of both the STRDS (i.e.: the container table) and the maps registered in it.</p>
    <p>Finally, we display the resulting map</p>
    <pre>
        <code class="neutral">
d.mon wx0
d.rast max_lst_date
        </code>
    </pre>
    <!--
    plot here
    -->
    <p>Now, we will extract the monthly and 3-month mean LST for points in a vector map.</p>
    <pre>
        <code class="neutral">
v.what.strds input=comm_colleges strds=LST_Day_monthly_celsius,LST_Day_mean_3month output=comm_colleges_lst
v.db.select map=comm_colleges_lst file=ts_points.csv
        </code>
    </pre>
    <p>Alternatively, for one STRDS:</p>
    <pre>
        <code class="neutral">
t.rast.what points=comm_colleges strds=LST_Day_monthly_celsius output=trastwhat_output.csv null_value=NA separator=comma
        </code>
    </pre>
    <p>We may also get spatially aggregated data for polygon vectors:</p>
    <pre>
        <code class="neutral">
# Install v.strds.stats add-on
g.extension v.strds.stats

v.strds.stats input=boundary_municp strds=LST_Day_monthly_celsius \
output=munic_aggr_lst method=average,minimum,maximum
v.db.select map=munic_aggr_lst file=ts_polygons.csv
        </code>
    </pre>
    </p>
    <h3>Temporal data visualization</h3>
    <pre>
        <code class="neutral">
g.gui.mapswipe
g.gui.animation
g.gui.tplot
        </code>
    </pre>
    <h2>Other (very) useful links</h2>
    <ul>
        <li><a href="https://ncsu-osgeorel.github.io/grass-intro-workshop/" target="_blank">https://ncsu-osgeorel.github.io/grass-intro-workshop/</a></li>
        <li>
            <a href="https://grasswiki.osgeo.org/wiki/Unleash_the_power_of_GRASS_GIS_at_US-IALE_2017" target="_blank">https://grasswiki.osgeo.org/wiki/Unleash_the_power_of_GRASS_GIS_at_US-IALE_2017</a>
        </li>
        <li><a href="https://grasswiki.osgeo.org/wiki/Temporal_data_processing" target="_blank">https://grasswiki.osgeo.org/wiki/Temporal_data_processing</a></li>
        <li><a href="http://ncsu-geoforall-lab.github.io/grass-temporal-workshop/" target="_blank">http://ncsu-geoforall-lab.github.io/grass-temporal-workshop/</a></li>
        <li>
            <a href="https://grasswiki.osgeo.org/wiki/Temporal_data_processing/GRASS_R_raster_time_series_processing" target="_blank">https://grasswiki.osgeo.org/wiki/Temporal_data_processing/GRASS_R_raster_time_series_processing</a>
        </li>
    </ul>
    <h2>References</h2>
    <ul>
        <li>Gebbert, S., Pebesma, E. (2014). <em>A temporal GIS for field based environmental modeling</em>. Environmental Modelling & Software, 53, 1â€“12. <a href="https://doi.org/10.1016/j.envsoft.2013.11.001" target="_blank">DOI</a></li>
        <li>Gebbert, S., Pebesma, E. (2017). <em>The GRASS GIS temporal framework</em>. International Journal of Geographical Information Science 31, 1273-1292. <a href="http://dx.doi.org/10.1080/13658816.2017.1306862" target="_blank">DOI</a></li>
        <li>Neteler, M., Bowman, M.H., Landa, M. and Metz, M. (2012): <em>GRASS GIS: a multi-purpose Open Source GIS</em>. Environmental Modelling & Software, 31: 124-130 <a href="http://dx.doi.org/10.1016/j.envsoft.2011.11.014" target="_blank">DOI</a></li>
        <li>Neteler, M., Mitasova, H. (2008): <em>Open Source GIS: A GRASS GIS Approach</em>. Third edition. ed. Springer, New York.<a href="https://grassbook.org/" target="_blank">book site</a></li>
    </ul>
    </p>
    <hr>
  </div>

</body>
</html>
